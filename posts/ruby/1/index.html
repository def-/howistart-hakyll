<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>How I Start.</title>

    <link href="../../../posts.rss" rel="alternate" type="application/rss+xml" title="How I Start." />

    <!-- Bootstrap core CSS -->
    <link href="../../../css/readable.min.css" rel="stylesheet" />

    <!-- Custom CSS for the 'Thumbnail Gallery' Template -->
    <link href="../../../css/1-col-portfolio.css" rel="stylesheet" />
    <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
      table.sourceCode { width: 100%; line-height: 100%; }
      td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
      td.sourceCode { padding-left: 5px; }
      code > span.kw { color: #007020; font-weight: bold; }
      code > span.dt { color: #902000; }
      code > span.dv { color: #40a070; }
      code > span.bn { color: #40a070; }
      code > span.fl { color: #40a070; }
      code > span.ch { color: #4070a0; }
      code > span.st { color: #4070a0; }
      code > span.co { color: #60a0b0; font-style: italic; }
      code > span.ot { color: #007020; }
      code > span.al { color: #ff0000; font-weight: bold; }
      code > span.fu { color: #06287e; }
      code > span.er { color: #ff0000; font-weight: bold; }
    </style>

  </head>
  <body>
    <nav class="navbar navbar-top navbar-inverse" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a class="navbar-brand" href="../../../">How I Start.</a>
    </div>

    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li class="category"><a href="../../../posts/clojure">clojure</a></li><li class="category"><a href="../../../posts/cpp">cpp</a></li><li class="category"><a href="../../../posts/elixir">elixir</a></li><li class="category"><a href="../../../posts/erlang">erlang</a></li><li class="category"><a href="../../../posts/go">go</a></li><li class="category"><a href="../../../posts/haskell">haskell</a></li><li class="category"><a href="../../../posts/nim">nim</a></li><li class="category"><a href="../../../posts/ruby">ruby</a></li>
      </ul>

      <ul class="nav navbar-nav navbar-right">
        <li><a href="../../../about.html">About</a></li>
      </ul>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>


    <div class="container">
      <div id="content">
        <div class="row">
  <div class="col-lg-12">
    <h1 class="page-header">
      Ruby <small>with Steve Klabnik</small>
    </h1>
  </div>
</div>

<div class="row">
  <div class="col-lg-10 col-lg-offset-1">
    <h2 id="intro">Intro</h2>
<p>Hi there! I’m Steve. <em>waves</em>. Let’s build a Ruby gem together!</p>
<p>There are a few key steps to building a gem. Here’s what we need to do:</p>
<ol style="list-style-type: decimal">
<li>Figure out what our gem needs to do.</li>
<li>Install git</li>
<li>Install Ruby</li>
<li>Generate the skeleton</li>
<li>Write some tests</li>
<li>Implement the code</li>
<li>Write some docs</li>
<li>Push to GitHub</li>
<li>Push to RubyGems</li>
<li>Tweet about it</li>
</ol>
<p>Ten easy steps. Let’s do this!</p>
<p>Oh, one more comment before I start: I use <code>vim</code> to do all of my editing. Many people also use Textmate on Mac OS X, and Sublime is becoming increasingly popular. But I like <code>vim</code>. I don’t use any plugins, either. I do like <a href="https://github.com/kien/ctrlp.vim">cntrl-p</a>. In general, I keep my tooling very vanilla; it helps when I pair, when I teach, and probably to tell you the truth I’m probably just lazy.</p>
<p>Anyway. Ten steps!</p>
<h2 id="figure-out-what-our-gem-needs-to-do.">Figure out what our gem needs to do.</h2>
<p>The most important part! Every gem needs some kind of raison d’être. Any time I have some Ruby code I think someone else might use, I try to extract it into a gem. This means I currently have push access to 38 gems, and I am a committer on many more. Oh well, everyone has to have a hobby…</p>
<p>In this case, we want to make a gem so that I can show you how I make a gem. So we’ve got a name, which is often the hardest part of making the damn thing. We’ll call it “<code>how_i_start</code>”. Even with just the name, we already have something to talk about: naming conventions. Ruby gems should be named with all lower case letters, and no punctuation other than <code>_</code> and <code>-</code>. Use <code>_</code> for separating words, and <code>-</code> to indicate an extension to an existing gem.</p>
<p>Not every single gem follows these conventions, especially if they are quite old. For example, <a href="https://rubygems.org/gems/activerecord"><code>activerecord</code></a> should really be <code>active_record</code>. If you’re starting a new gem, don’t contribute to this confusion! You can find a slightly more full description of these naming guidelines <a href="http://guides.rubygems.org/name-your-gem/">on the RubyGems Guides</a>.</p>
<p>So, we’ve got a name, but what should it do? Let’s make it do something very simple: we’ll include a simple executable that prints out a link to this article. That’ll be a very small amount of behavior, and also be relevant.</p>
<p>I’ve already written and released a gem with this name, so if you want to push your own version of the RubyGem, you’ll have to change it to something else. Sorry about that! Maybe try the extension convention for names, and call yours <code>how_i_start-jonathan</code>. Of course, only do that if your name is Jonathan, or he’ll be really disappointed when he reads this article. I’ve got your back, Jonathan!</p>
<h2 id="install-git">Install git</h2>
<p>Rubyists use <code>git</code> to manage versions. If you don’t like it, well… sorry. You’re gonna have a bad time. Everything in Ruby world assumes <code>git</code>.</p>
<p>Since I’m on a Debian-based Linux, I just type this:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">apt-get</span> install git</code></pre></div>
<p>Done. This is probably the easiest step in the whole thing. Well, maybe not. But one command is pretty easy.</p>
<p>You can’t skip this step. Later, our tools will assume that we have <code>git</code> installed. It’s a bit fascist, I’ll admit, but at least the trains run on time. :[</p>
<h2 id="install-ruby">Install Ruby</h2>
<p>We can’t make a gem without Ruby! It’s also essential to use some sort of tool to switch between different Ruby versions, as well. When a new version of Ruby comes out, we want all those new goodies.</p>
<p>There are a bunch of options here, but I prefer minimalism. I use <a href="https://github.com/sstephenson/ruby-build">ruby-build</a> to install Ruby, and <a href="https://github.com/postmodern/chruby">chruby</a> (“chuh ruby”) to <strong>ch</strong>ange between different <strong>ruby</strong>s.</p>
<p>Oh, I should also mention that I use Linux almost exclusively. These instructions will also work almost unchanged on an Apple computer, if you happen to be like many Rubyists. If you’re on Windows, I highly recommend <a href="http://rubyinstaller.org/">RubyInstaller</a>. I don’t use a version switcher when I’m on Windows.</p>
<p>Let’s install <code>ruby-build</code> so we can build and install a Ruby. I wonder if I could have fit more ‘install’ and ‘build’ and ‘Ruby’ into that sentence. Anyway, it’s simple:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">git</span> clone https://github.com/sstephenson/ruby-build.git
<span class="kw">cd</span> ruby-build
<span class="kw">./install.sh</span></code></pre></div>
<p>You may need a <code>sudo</code> if you don’t have permissions to install to <code>/usr/local</code>.</p>
<p>On my machine, <code>/usr/local/bin</code> is already in my <code>$PATH</code>, so it just works:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">ruby-build</span> --definitions</code></pre></div>
<p>This prints out all the different versions of Ruby that <code>ruby-build</code> knows how to build:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">ruby-build</span> --definitions <span class="kw">|</span> <span class="kw">wc</span> -l
<span class="kw">109</span></code></pre></div>
<p>Whoah, 109 versions so far!</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">ruby-build</span> --definitions <span class="kw">|</span> <span class="kw">grep</span> <span class="st">&quot;2\.1&quot;</span>
<span class="kw">2.1.0</span>
<span class="kw">2.1.0-dev</span>
<span class="kw">2.1.0-preview1</span>
<span class="kw">2.1.0-preview2</span>
<span class="kw">2.1.0-rc1</span>
<span class="kw">2.1.1</span>
<span class="kw">rbx-2.1.0</span>
<span class="kw">rbx-2.1.1</span>
<span class="kw">rbx-2.2.1</span></code></pre></div>
<p>Ruby 2.1 is the latest version of Ruby that’s out right now, and there’s even a bunch of them! We want <code>2.1.1</code>. Let’s build it:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">ruby-build</span> 2.1.1 ~/.rubies/2.1.1</code></pre></div>
<p>You tell <code>ruby-build</code> which version of Ruby to build, and where you want to put it. <code>~/.rubies</code> is one of the places that <code>chruby</code> looks by default, and I like that each user on the machine can have their own Rubies. I mean, I’m the only person (other than the NSA, probably) that is using my laptop, but still, keeping it all local to your regular user is nice.</p>
<p>That should run for a while, and then you have a Ruby installed! Next, <code>chruby</code>. <code>chruby</code> is sweet because you’re able to type:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">chruby</span> 2.0.0
$ <span class="kw">ruby</span> -v
<span class="kw">ruby</span> 2.0.0p0 (2014-01-01) [<span class="kw">x86_64-linux</span>]
$ <span class="kw">chruby</span> 2.1.1
<span class="kw">ruby</span> 2.1.1p76 (2014-02-24 revision 45161) [<span class="kw">x86_64-linux</span>]</code></pre></div>
<p>Nice and easy. It’s great for being able to test your gem against multiple Ruby versions, or when a new Ruby comes out that you’d like to use.</p>
<p>Let’s install it:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">wget</span> -O chruby-0.3.8.tar.gz https://github.com/postmodern/chruby/archive/v0.3.8.tar.gz
$ <span class="kw">tar</span> -xzvf chruby-0.3.8.tar.gz
$ <span class="kw">cd</span> chruby-0.3.8/
$ <span class="kw">sudo</span> make install</code></pre></div>
<p>You then have to do one more thing: add a line to your shell’s profile. I use bash, so mine is <code>~/.bashrc</code>. If you’re cooler than me, you’ll probably edit <code>~/.zshrc</code>. Either way, add this line:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">source</span> /usr/local/share/chruby/chruby.sh</code></pre></div>
<p>This loads up <code>chruby</code>, which is basically just a shell script. I happen to like automatically switching to a particular Ruby, so I also add</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">chruby</span> 2.1.1</code></pre></div>
<p>This means that I’ll always have 2.1.1 right at my fingertips. Of course, given that it’s a shell script, this is also how you use <code>chruby</code>. Just type the version after the name, and you’re good to go. Easy peasy.</p>
<p>That’s it for tooling! We’re all good to go. Now, let’s dig in to the gem-building specific stuff.</p>
<h2 id="generate-the-skeleton">Generate the skeleton</h2>
<p>Turns out that we’re barely gonna even need to do any setup, as there’s a tool that does it for us. Ruby is super-huge on convention, so that means we have pretty awesome tools. They’d be even better with static types, but what’cha gonna do?</p>
<p>To do the generating, we need to install <a href="http://bundler.io/">Bundler</a>. There are only two Rubists in the world who don’t use Bundler. I’m only half-kidding. Bundler’s main job is to help you deal with versions of the dependencies your application needs. But since it does that, it also comes with an awesome generator to help you make gems. It’s going to do 90% of the work for us.</p>
<p>First, we need to install Bundler. It’s as easy as</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">gem</span> install bundler</code></pre></div>
<p>Once that’s done, we run a very similar, but different, command. This generates a skeleton for our gem’s meat to build on top of.</p>
<p>That sentence was kinda gross. Sorry. Anyway:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">bundle</span> gem how_i_start
      <span class="kw">create</span>  how_i_start/Gemfile
      <span class="kw">create</span>  how_i_start/Rakefile
      <span class="kw">create</span>  how_i_start/LICENSE.txt
      <span class="kw">create</span>  how_i_start/README.md
      <span class="kw">create</span>  how_i_start/.gitignore
      <span class="kw">create</span>  how_i_start/how_i_start.gemspec
      <span class="kw">create</span>  how_i_start/lib/how_i_start.rb
      <span class="kw">create</span>  how_i_start/lib/how_i_start/version.rb
<span class="kw">Initializing</span> git repo in /home/steve/src/how_i_start
$</code></pre></div>
<p>See? Told you we needed <code>git</code>. Here’s what these files do:</p>
<h3 id="gemfile">Gemfile</h3>
<p>The <code>Gemfile</code> is the main file that Bundler uses to track versions of all the dependencies our gem needs. It does this through an interesting mechanism:</p>
<pre><code>$ cat Gemfile
source 'https://rubygems.org'

# Specify your gem's dependencies in how_i_start.gemspec
gemspec</code></pre>
<p>Surprise! Your dependencies are in another castle. Bundler knows how to figure them out from our gemspec, which we’ll talk about in a moment. We don’t need to edit this file at all, it works just fine.</p>
<h3 id="rakefile">Rakefile</h3>
<p>Rake is Ruby’s version of the venerable Make tool for building things. We don’t need to edit this either, as it already contains the stuff needed to do a bunch of cool things:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">bundle</span> exec rake -T
<span class="kw">rake</span> build    <span class="co"># Build how_i_start-0.0.1.gem into the pkg directory</span>
<span class="kw">rake</span> install  <span class="co"># Build and install how_i_start-0.0.1.gem into system gems</span>
<span class="kw">rake</span> release  <span class="co"># Create tag v0.0.1 and build and push how_i_start-0.0.1.gem to Ru...</span></code></pre></div>
<p>These three commands help us with making a gem. <code>rake build</code> will attempt to package up our gem. <code>rake install</code> will <code>rake build</code>, and then install it into our Ruby, so we can give it a whirl. Finally, <code>rake release</code> will actually release our gem. We’ll talk more about all this later.</p>
<h3 id="license.txt">LICENSE.txt</h3>
<p>Rubyists almost exclusively love the MIT license, because it makes making money really, really easy. I say all kinds of controversial political things on Twitter, and everybody shrugs. As soon as I suggest that I <em>might</em> use the GPL, people lose their cool.</p>
<p>You should use whatever license you want. I won’t judge you. Everyone else might, though. :/.</p>
<h3 id="readme.md">README.md</h3>
<p>Bundler gives us a pretty okay README to start with. We’ll modify this more soon. The <code>md</code> stands for Markdown, the One True Document Format.</p>
<h3 id="gitignore">.gitignore</h3>
<p>Bundler is kind enough to make sure to create a decent ignore file for <code>git</code> so that we don’t check bad things in. There’s one thing that’s different when you’re making a gem, and that’s the <code>Gemfile.lock</code>. Normally, if you were building an app, you’d check this in, but when you’re making a gem, you don’t. If you don’t know why this is, <a href="http://yehudakatz.com/2010/12/16/clarifying-the-roles-of-the-gemspec-and-gemfile/">go read this</a>.</p>
<h3 id="how_i_start.gemspec">how_i_start.gemspec</h3>
<p>This file specifies all the metadata for our gem. The default values are decent, but I’m going to edit them, and <strong>then</strong> show you the output.</p>
<p>Okay, I’m done. Here it is. Substitute your own details, unless you’re me.</p>
<div class="sourceCode"><pre class="sourceCode ruby"><code class="sourceCode ruby">$ cat how_i_start.gemspec
<span class="co"># coding: utf-8</span>
lib = <span class="dt">File</span>.expand_path(<span class="st">'../lib'</span>, <span class="dv">__FILE__</span>)
<span class="dt">$LOAD_PATH</span>.unshift(lib) <span class="kw">unless</span> <span class="dt">$LOAD_PATH</span>.include?(lib)
require <span class="st">'how_i_start/version'</span>

<span class="dt">Gem</span>::<span class="dt">Specification</span>.new <span class="kw">do</span> |spec|
  spec.name          = <span class="st">&quot;how_i_start&quot;</span>
  spec.version       = <span class="dt">HowIStart</span>::<span class="dt">VERSION</span>
  spec.authors       = [<span class="st">&quot;Steve Klabnik&quot;</span>]
  spec.email         = [<span class="st">&quot;steve@steveklabnik.com&quot;</span>]
  spec.summary       =<span class="ot"> %q{</span><span class="st">A simple gem, to show you how I do things.</span><span class="ot">}</span>
  spec.description   =<span class="ot"> %q{</span><span class="st">A simple gem, to show you how I do things. If it were more complicated, I'd explain more about it here.</span><span class="ot">}</span>
  spec.homepage      = <span class="st">&quot;https://steveklabnik.github.io/how_i_do_things&quot;</span>
  spec.license       = <span class="st">&quot;MIT&quot;</span>

  spec.files         = <span class="st">`git ls-files -z`</span>.split(<span class="st">&quot;\x0&quot;</span>)
  spec.executables   = spec.files.grep(<span class="ot">%r{^bin/}</span>) { |f| <span class="dt">File</span>.basename(f) }
  spec.test_files    = spec.files.grep(<span class="ot">%r{^(test|spec|features)/}</span>)
  spec.require_paths = [<span class="st">&quot;lib&quot;</span>]

  spec.add_development_dependency <span class="st">&quot;bundler&quot;</span>, <span class="st">&quot;~&gt; 1.6&quot;</span>
  spec.add_development_dependency <span class="st">&quot;rake&quot;</span>
<span class="kw">end</span></code></pre></div>
<p>The first part sets up loading paths. The real meat is in the block. It’s all pretty basic stuff. The second of the three blocks is kinda interesting, but you never need to touch the generated files. Basically, they use Git Magic (tm) to figure out which files should be included in your gem. This means that you’ll never accidentally distribute the wrong files, unless you forget to commit them. And if they’re not committed, they don’t exist. You know it’s true.</p>
<p>The <code>require_paths</code> line is a Ruby convention: all the files for your library go in <code>lib</code>.</p>
<p>The last two are interesting, too: they say that in order to work on our gem, we need <code>bundler</code> and <code>rake</code>. If we were using a special test framework, we’d add it here. <code>add_development_dependency</code> has a sibling method that we won’t use, but I feel like I should tell you about: <code>add_dependency</code>. If our gems needed other gems to work, we’d use that to add them, here. These two methods are what Bundler uses to figure out what to install when we’re working on our gem, and what Rubygems uses to figure out what to install when we’re installing our gem. TL;DR: they’re super important.</p>
<p>Whew! That file is the most important, as it tells us where everything else goes. Let’s move on.</p>
<h3 id="libhow_i_start.rb">lib/how_i_start.rb</h3>
<p>As I mentioned, this file is in <code>lib</code> because that’s where our files go. This file has the same name as the gem, so it’s the file that gets required when you say <code>require &quot;how_i_start&quot;</code> in a Ruby program. Very important.</p>
<h3 id="libhow_i_startversion.rb">lib/how_i_start/version.rb</h3>
<p>This file contains just a few lines:</p>
<div class="sourceCode"><pre class="sourceCode ruby"><code class="sourceCode ruby">$ cat lib/how_i_start/version.rb
<span class="kw">module</span> <span class="dt">HowIStart</span>
  <span class="dt">VERSION</span> = <span class="st">&quot;0.0.1&quot;</span>
<span class="kw">end</span></code></pre></div>
<p>By keeping this constant in its own file, we can not load up our entire gem when we need to check what version it is. Careful readers will notice that our Gemspec did this, exactly.</p>
<p>You’ll edit this file when you’re about to release a new version of the gem.</p>
<h2 id="write-some-tests">Write some tests</h2>
<p>Step four! Every Rubyist except for DHH believes in test-driven development, so we’ll write a test first. This test will be very, very simple.</p>
<p>I prefer to use <code>minitest</code> for testing, as it’s included with Ruby. I don’t find the extra complexity of other testing frameworks particularly worthwhile, though I will say that RSpec’s mocking framework is kinda nice.</p>
<p>To do this, we need to do a few things:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">mkdir</span> test
$ <span class="kw">touch</span> test/url_test.rb</code></pre></div>
<p>This is the <code>minitest</code> convention. Test files are placed in <code>test</code> folder, ending with <code>_test.rb</code>. We’ll also need to add a few lines to the <code>Rakefile</code>:</p>
<div class="sourceCode"><pre class="sourceCode ruby"><code class="sourceCode ruby">$ cat <span class="dt">Rakefile</span>
require <span class="st">&quot;bundler/gem_tasks&quot;</span>

require <span class="st">&quot;rake/testtask&quot;</span>

<span class="dt">Rake</span>::<span class="dt">TestTask</span>.new <span class="kw">do</span> |t|
  t.test_files = <span class="dt">FileList</span>[<span class="st">'test/*_test.rb'</span>]
<span class="kw">end</span>

task <span class="st">default: :test</span></code></pre></div>
<p>That first line was there from Bundler. It’s what made the previous three tasks we discussed. You have to add the rest. The first line requires the necessary stuff from Rake. The second instantiates the task. The line in the block tells the task where to find our files. Finally, we set our default task to run our tests.</p>
<p>Check to see if it works:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">bundle</span> exec rake
$ <span class="kw">echo</span> <span class="ot">$?</span>
<span class="kw">0</span>
$</code></pre></div>
<p>Cool. We don’t have any tests, so we don’t have any output. Let’s make a test!</p>
<div class="sourceCode"><pre class="sourceCode ruby"><code class="sourceCode ruby">$ cat test/url_test.rb
require <span class="st">&quot;minitest/autorun&quot;</span>

require <span class="st">&quot;how_i_start&quot;</span>

<span class="kw">class</span> <span class="dt">UrlTest</span> &lt; <span class="dt">Minitest</span>::<span class="dt">Test</span>
  <span class="kw">def</span> test_url
    assert_equal <span class="st">&quot;http://howistart.org/posts/ruby/1&quot;</span>, <span class="dt">HowIStart</span>::<span class="dt">Url</span>
  <span class="kw">end</span>
<span class="kw">end</span></code></pre></div>
<p>Easy enough! We start off by requiring the test runner, requiring our library, and then we make a class to hold our test. One method, starting with <code>test_</code>, is our test itself. We have one simple assertion, which checks that we’ve set a constant to the URL of this post. Nice and easy.</p>
<p>The most important part of TDD is to run your tests and watch them fail. Here we go!</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">bundle</span> exec rake
<span class="kw">Run</span> options: --seed 28249

<span class="co"># Running:</span>

<span class="kw">E</span>

<span class="kw">Finished</span> in 0.001131s, 884.3719 runs/s, 0.0000 assertions/s.

  <span class="kw">1</span>) <span class="kw">Error</span>:
<span class="kw">UrlTest</span>#test_url:
<span class="kw">NameError</span>: uninitialized constant HowIStart::Url
    <span class="kw">/home/steve/src/how_i_start/test</span>/url_test.rb:<span class="kw">5</span>:in <span class="kw">`test_url</span><span class="st">'</span>

<span class="st">1 runs, 0 assertions, 0 failures, 1 errors, 0 skips</span>
<span class="st">rake aborted!</span>
<span class="st">Command failed with status (1): [ruby -I&quot;lib&quot; -I&quot;/home/steve/.gem/ruby/2.1.1/gems/rake-10.3.2/lib&quot; &quot;/home/steve/.gem/ruby/2.1.1/gems/rake-10.3.2/lib/rake/rake_test_loader.rb&quot; &quot;test/url_test.rb&quot; ]</span>

<span class="st">Tasks: TOP =&gt; default =&gt; test</span>
<span class="st">(See full trace by running task with --trace)</span></code></pre></div>
<p>It doesn’t know what our constant is. Perfect.</p>
<h2 id="implement-the-code">Implement the code</h2>
<p>Let’s actually define our constant:</p>
<div class="sourceCode"><pre class="sourceCode ruby"><code class="sourceCode ruby">$ cat lib/how_i_start.rb
require <span class="st">&quot;how_i_start/version&quot;</span>

<span class="kw">module</span> <span class="dt">HowIStart</span>
  <span class="dt">Url</span> = <span class="st">&quot;http://howistart.org/posts/ruby/1&quot;</span>
<span class="kw">end</span></code></pre></div>
<p>Note that that’s indented by two spaces, no tabs. Frankly, indenting your code with two spaces and no tabs is more important than getting the rest of the syntax right, if you ask a random Rubyist.</p>
<p>Now we can run our test again:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">bundle</span> exec rake
<span class="kw">Run</span> options: --seed 43182

<span class="co"># Running:</span>

<span class="kw">.</span>

<span class="kw">Finished</span> in 0.001069s, 935.6953 runs/s, 935.6953 assertions/s.

<span class="kw">1</span> runs, 1 assertions, 0 failures, 0 errors, 0 skips</code></pre></div>
<p>:heart_eyes:. We’ve passed the test! That was easy!</p>
<p>Just defining a constant isn’t quite enough, though. Let’s add an executable. Executables are stored in <code>bin</code>:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">mkdir</span> bin</code></pre></div>
<p>Put this in it:</p>
<div class="sourceCode"><pre class="sourceCode ruby"><code class="sourceCode ruby">$ cat bin/how_i_start
<span class="kw">#!/usr/bin/env ruby</span>

require <span class="st">'how_i_start'</span>

puts <span class="dt">HowIStart</span>::<span class="dt">Url</span></code></pre></div>
<p>This is actually a script. We don’t add an extension, but we do use a ‘shebang’ line to tell the shell that this is a Ruby script. We then load our library, and print our constant.</p>
<p>I don’t tend to test ‘binaries.’ All the logic should go in the gem itself, the binary is just a thin shim to shove the command-line options to the Real Code.</p>
<h2 id="write-some-docs">Write some docs</h2>
<p>Use Rdoc. If it doesn’t work, use <a href="http://yardoc.org/">YARD</a>. I include this comment here because docs are really, really important. We don’t really have much to document, though. We’ll just add some comments:</p>
<div class="sourceCode"><pre class="sourceCode ruby"><code class="sourceCode ruby">$ cat lib/how_i_start.rb
require <span class="st">&quot;how_i_start/version&quot;</span>

<span class="co"># All code in the gem is namespaced under this module.</span>
<span class="kw">module</span> <span class="dt">HowIStart</span>

  <span class="co"># The URL of the article about how I start.</span>
  <span class="dt">Url</span> = <span class="st">&quot;http://howistart.org/posts/ruby/1&quot;</span>
<span class="kw">end</span>
$ cat lib/how_i_start/version.rb
<span class="kw">module</span> <span class="dt">HowIStart</span>

  <span class="co"># The current version of HowIStart.</span>
  <span class="dt">VERSION</span> = <span class="st">&quot;0.0.1&quot;</span>
<span class="kw">end</span></code></pre></div>
<p>Rdoc will parse these comments to generate documentation. You can get more complicated than this, but it gives you the general idea. Generating the documentation is really easy:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">rdoc</span> lib
<span class="kw">Parsing</span> sources...
<span class="kw">100%</span> [ 2/ 2]  lib/how_i_start/version.rb

<span class="kw">Generating</span> Darkfish format into /home/steve/src/how_i_start/doc...

  <span class="kw">Files</span>:      2

  <span class="kw">Classes</span>:    0 (0 undocumented)
  <span class="kw">Modules</span>:    1 (0 undocumented)
  <span class="kw">Constants</span>:  2 (0 undocumented)
  <span class="kw">Attributes</span>: 0 (0 undocumented)
  <span class="kw">Methods</span>:    0 (0 undocumented)

  <span class="kw">Total</span>:      3 (0 undocumented)
  <span class="kw">100.00%</span> documented

  <span class="kw">Elapsed</span>: 0.0s
$ <span class="kw">firefox</span> doc/index.html</code></pre></div>
<p>RDoc can tell us if we’re missing any documentation. Awesome. I always open up the HTML docs in my browser to see if they look okay.</p>
<h2 id="push-to-github">Push to GitHub</h2>
<p>Rubyists assume you use GitHub. It was originally created by some Rubyists, lots of early users were Rubyists. If you like a different code hosting platform, sorry. :/. I can only think of one gem that I use that doesn’t use GitHub.</p>
<p>Make a new GitHub repository with the same name as your gem, and then use <code>git</code> to push it up:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> add .
$ <span class="kw">git</span> commit -m <span class="st">&quot;Initial commit.&quot;</span>
$ <span class="kw">git</span> remote add origin git@github.com:steveklabnik/how_i_start.git
$ <span class="kw">git</span> push -u origin master</code></pre></div>
<p>Refresh at will. Neat!</p>
<p>Oh no! It looks like we didn’t write a good README. Let’s fix that. Here’s my diff:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> diff --cached
<span class="kw">diff</span> --git a/README.md b/README.md
<span class="kw">index</span> 9c664a3..731d6f7 100644
<span class="kw">---</span> a/README.md
<span class="kw">+++</span> b/README.md
<span class="kw">@@</span> -1,24 +1,22 @@
 <span class="co"># HowIStart</span>

<span class="kw">-TODO</span>: Write a gem description
<span class="kw">+HowIStart</span> is a very simple example gem to show you how I begin a Ruby project.

 <span class="co">## Installation</span>

<span class="kw">-Add</span> this line to your application<span class="st">'s Gemfile:</span>
<span class="st">-</span>
<span class="st">-    gem '</span>how_i_start<span class="st">'</span>
<span class="st">-</span>
<span class="st">-And then execute:</span>
<span class="st">-</span>
<span class="st">-    $ bundle</span>
<span class="st">-</span>
<span class="st">-Or install it yourself as:</span>
<span class="st">+Install it yourself as:</span>

<span class="st">     $ gem install how_i_start</span>

<span class="st"> ## Usage</span>

<span class="st">-TODO: Write usage instructions here</span>
<span class="st">+Just run the executable:</span>
<span class="st">+</span>
<span class="st">+```</span>
<span class="st">+$ how_i_start</span>
<span class="st">+```</span>
<span class="st">+</span>
<span class="st">+And it will point you at the article.</span>

<span class="st"> ## Contributing</span></code></pre></div>
<p>Let’s commit that too:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> add README.md
$ <span class="kw">git</span> commit -m <span class="st">&quot;Fix up README.&quot;</span>
$ <span class="kw">git</span> push origin master</code></pre></div>
<p>Much better.</p>
<h2 id="push-to-rubygems">Push to RubyGems</h2>
<p>Let’s release this sucker!</p>
<p>First thing to do is to make sure that packaging it all up works. Let’s try:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">bundle</span> exec rake install
<span class="kw">how_i_start</span> 0.0.1 built to pkg/how_i_start-0.0.1.gem.
<span class="kw">how_i_start</span> (0.0.1) <span class="kw">installed.</span>
<span class="kw">steve@computer</span>:~/src/how_i_start$ how_i_start
<span class="kw">http</span>://howistart.org/posts/ruby/1</code></pre></div>
<p>Great! It successfully built the package, and our ‘binary’ works. Since this is a feature-complete version of the gem, we should bump the version to 1.0.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cat</span> lib/how_i_start/version.rb
<span class="kw">module</span> HowIStart

  <span class="co"># The current version of HowIStart.</span>
  <span class="kw">VERSION</span> = <span class="st">&quot;1.0.0&quot;</span>
<span class="kw">end</span>
$ <span class="kw">git</span> add lib/how_i_start/version.rb
$ <span class="kw">git</span> commit -m <span class="st">&quot;Bump version for 1.0 release&quot;</span>
[<span class="kw">master</span> 499c1c0] Bump version for 1.0 release
 <span class="kw">1</span> file changed, 1 insertion(+), <span class="kw">1</span> deletion(-)
$ <span class="kw">bundle</span> exec rake release
<span class="kw">how_i_start</span> 1.0.0 built to pkg/how_i_start-1.0.0.gem.
<span class="kw">Tagged</span> v1.0.0.
<span class="kw">Pushed</span> git commits and tags.
<span class="kw">Pushed</span> how_i_start 1.0.0 to rubygems.org.</code></pre></div>
<p>We just increase the version, commit it, and then run the Rake task that Bundler gave us. Since this isn’t my first time, it uses my saved credentials, but it might ask you for yours.</p>
<h2 id="tweet-about-it">Tweet about it</h2>
<p>If a gem gets released in a forest, and nobody is there to hear it, it certainly… yeah okay, that didn’t really work out. My point is, if you make a gem, and nobody knows about it, then it’s not very useful. Promotion is hard, but there is an answer: Twitter. <a href="https://twitter.com/peterc/status/475292959337103360">Even people that hate Twitter post stuff to Twitter</a>. It’s just the way of the Ruby world.</p>
<p>So do this:</p>
<blockquote class="twitter-tweet" lang="en">
<p>
I've just released “How I Start” 1.0! 

$ gem install how_i_start

<a href="https://t.co/R5m6ODxOZB">https://t.co/R5m6ODxOZB</a>
</p>
— Brooklyn.rs (<span class="citation">@steveklabnik</span>) <a href="https://twitter.com/steveklabnik/statuses/479671271832444928">June 19, 2014</a>
</blockquote>
<p>It’s worth following a bunch of Ruby people on Twitter. Figure out who makes the gems you use, and follow them. Getting to know people is cool, but even if you hate that, you can <a href="https://twitter.com/steveklabnik/status/479671346314883073">find out about things before they really happen</a>.</p>
<p>Don’t be shy, though. You’ve made something useful! We all want to use it!</p>
<h2 id="conclusion">Conclusion</h2>
<p>That’s it! None of it is particularly difficult by itself, but there is a bunch when you put it all together. Please take these ten simple steps and write some great gems! I know you have it in you!</p>
  </div>
</div>

<div class="row">
  <div class="col-lg-10 col-lg-offset-1">
    <hr />
  </div>
</div>


<div class="row">
  <div class="col-lg-6 col-lg-6">
    <div class="col-lg-5 col-lg-offset-5">
      <img class="img-responsive" src="../../../posts/ruby/1/images/headshot.png" alt>
    </div>
  </div>

  <div class="col-lg-6 col-lg-6">
    <h3>Steve Klabnik</h3>
    <h4>Ruby</h4>
    <h3><small> Rails Core Committer & Author of Rails 4 in Action</small></h3>
    <p><a href="https://twitter.com/steveklabnik/">Steve</a> is a long time <a href="http://rubyonrails.org/">Rails</a> core comitter and author of <a href="http://www.designinghypermediaapis.com/">Designing with Hypermedia API's</a>, <a href="http://www.rustforrubyists.com/">Rust for Rubyists</a>, and <a href="http://www.manning.com/bigg2/">Rails 4 in Action</a>. Currently Steve is providing his documentation expertise to <a href="http://mozilla.org">Mozilla</a> to improve and expand the <a href="http://www.rust-lang.org/">Rust</a> documentation.</p>
    <a class="btn btn-primary" href="../../../posts/ruby/1/index.html">Read <span class="glyphicon glyphicon-chevron-right"></span></a>
  </div>
</div>

      </div>

      <footer>
        <hr />
        <div class="row">
          <div class="col-md-4 col-md-offset-8">
            <p class="text-right">
              <small>Except where otherwise noted.</small>
              <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/" title="Creative Commons License Details">
                <img src="../../../images/cc.png" alt="Creative Commons Attribution Non-Commercial No Derivative License" />
              </a>
            </p>
          </div>
        </div>
      </footer>
    </div>

    <!-- JavaScript -->
    <script src="../../../js/jquery-1.10.2.js"></script>
    <script src="../../../js/bootstrap.js"></script>

  </body>
</html>
